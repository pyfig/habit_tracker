# Трекер привычек

Готовое к контейнерам приложение для формирования и поддержания ежедневных привычек.  
Создавайте, редактируйте, архивируйте, восстанавливайте привычки и отслеживайте прогресс через календарь.

---

## Возможности
### Аутентификация
* **Регистрация / Вход / Выход** (JWT)

### Управление привычками
* **Создание / Редактирование / Удаление**
* **Архивирование** и **Восстановление**
* **Отметка «выполнено» / отмена**

### Отслеживание прогресса
* **Ежедневные отметки выполнения**
* **Календарь** с визуализацией цепочек
* **Список выполненных сегодня**
* **Удаление отметки**

---

## API

| Метод | Эндпоинт                               | Описание                           | Авторизация |
|-------|----------------------------------------|-------------------------------------|-------------|
| POST  | `/api/auth/register`                   | Регистрация пользователя           | ❌ |
| POST  | `/api/auth/login`                      | Получение JWT-токена               | ❌ |
| GET   | `/api/habits/`                         | Список активных привычек           | ✅ |
| POST  | `/api/habits/`                         | Создать привычку                   | ✅ |
| PUT   | `/api/habits/{habit_id}`               | Обновить привычку                  | ✅ |
| DELETE| `/api/habits/{habit_id}`               | Удалить привычку                   | ✅ |
| POST  | `/api/habits/{habit_id}/archive`       | Архивировать привычку              | ✅ |
| POST  | `/api/habits/{habit_id}/restore`       | Восстановить привычку              | ✅ |
| GET   | `/api/habits/archived`                 | Список архивных привычек           | ✅ |
| GET   | `/api/habits/completed`                | Список выполненных привычек        | ✅ |
| POST  | `/api/habits/{habit_id}/complete`      | Пометить выполненной сегодня       | ✅ |
| POST  | `/api/habits/{habit_id}/uncomplete`    | Снять отметку выполнения           | ✅ |
| POST  | `/api/marks/`                          | Создать отметку на дату            | ✅ |
| GET   | `/api/marks/habit/{habit_id}/`         | Все отметки привычки               | ✅ |
| DELETE| `/api/marks/{mark_id}`                 | Удалить отметку                    | ✅ |
| GET   | `/`                                    | Проверка работоспособности         | ❌ |

> **✅** Требуется заголовок `Authorization: Bearer <token>` — токен берётся из `/api/auth/login`.

---

## Быстрый старт

### Требования
* Docker & Docker Compose  
* Git

```bash
git clone https://github.com/your-org/habit_tracker.git
cd habit_tracker
cp .env.example .env
./main.sh                 # собирает образы и поднимает весь стек
````

| Сервис   | URL                                            |
| -------- | ---------------------------------------------- |
| Бэкенд   | [http://localhost:8000](http://localhost:8000) |
| Фронтенд | [http://localhost:3000](http://localhost:3000) |

Фронтенд — статичный SPA (HTML / CSS / vanilla JS), отдаётся Nginx.

---

## Тесты и покрытие

```bash
# в корне проекта
./tests.sh                       # отчёт в results.txt
                                 # поднимает Postgres → pytest → выводит покрытие
```

`tests.sh` собирает образ **tests**, запускает контейнер базы, выполняет `pytest --cov`,
сохраняет текстовый отчёт в `results.txt`

---

## Непрерывная интеграция

GitHub Actions выполняет линтинг и тесты при каждом пуше. Секреты (например,
токен Telegram) хранятся в разделе **Settings → Secrets and variables**.
Каждый джоб отправляет результат в Telegram через `appleboy/telegram-action`.

Для ручного запуска CI отправьте боту команду `/run_ci`.

---

## Структура проекта

```
📦 habit_tracker
├─ backend/             # FastAPI
│  ├─ app/              # роуты, модели, схемы, auth, main.py
│  └─ tests/            # pytest (в контейнере)
├─ frontend/            # Статичный SPA
├─ tests.sh             # запуск тестов (Docker Compose)
├─ main.sh              # полный запуск приложения
├─ pytest.ini           # конфиг pytest + порог покрытия
├─ docker-compose.yml   # db, backend, frontend, tests
└─ README.md / README_RUS.md
```

---

## Планы

* ✅ JWT-аутентификация, архив/восстановление, календарь, > 80 % покрытие
* 🚀 Дашборд Grafana с метриками
* 🚀 Telegram-уведомления о выполненных привычках

